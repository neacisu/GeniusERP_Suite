# F0.5 Security Validation & Chaos Testing

## Overview

This document describes the validation strategy for the F0.5 Security Refactoring (OpenBao, Process Supervisor, OIDC). It includes integration tests and chaos scenarios to ensure the system is resilient.

## Test Scenarios

### 1. Secret Injection Verification

**Goal**: Confirm that applications receive secrets from OpenBao via the Process Supervisor.
**Method**:

- Start application.
- Check for existence of `/app/secrets/db-creds.json`.
- Verify environment variables are populated (without logging values).

### 2. Lease Expiry & Renewal

**Goal**: Confirm that OpenBao Agent automatically renews leases.
**Method**:

- Set short TTL (e.g., 1m) or manually revoke lease.
- Observe OpenBao Agent logs for renewal events.
- Verify application continues to function.

### 3. Chaos: OpenBao Down

**Goal**: Verify application behavior when OpenBao is unavailable.
**Method**:

- Stop OpenBao container.
- Observe application logs (should retry or exit gracefully depending on config).
- Restart OpenBao.
- Verify application recovers (Agent should reconnect).

## Automation

### Local Chaos Script

`scripts/security/test-f05-chaos.sh` performs these tests locally using Docker Compose.

### CI Workflow

`.github/workflows/ci-f05-validation.yml` runs these tests in GitHub Actions on a nightly schedule.

## Execution

To run locally:

```bash
./scripts/security/test-f05-chaos.sh
```
